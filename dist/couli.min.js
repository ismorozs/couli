!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Couli=t():e.Couli=t()}(this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t,n){"use strict";function r(e){return"[object Array]"===u(e)}function a(e){return"[object Object]"===u(e)}function i(e){return r(e)&&1===e.length&&a(e[0])}function o(e){return"[object String]"===u(e)}function u(e){return Object.prototype.toString.call(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=function(e){return"[object Function]"===u(e)},t.isArray=r,t.isObject=a,t.isObjectInBrackets=i,t.isObjectInDoubleBrackets=function(e){return r(e)&&1===e.length&&i(e[0])},t.isString=o,t.isHTMLString=function(e){return o(e)&&0===e.indexOf("<")},t.isNumber=function(e){return"[object Number]"===u(e)&&e==e},t.isDOMElement=function(e){return e&&void 0!==e.tagName},t.isUndefined=function(e){return void 0===e},t.isEmpty=function(e){if(!e)return!0;if(r(e)||o(e))return!e.length;return!Object.keys(e).length},t.isLink=function(e){var t=e.indexOf("/");return[0,1,2].some(function(e){return e===t})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitPiece=t.fullMap=t.toObject=t.filter=t.mapKeys=t.map=t.forEach=t.addConstFields=t.remove=t.set=t.get=void 0;var r=n(0);t.get=function(e,t){for(var n=e,r=0;r<t.length;r++)try{n=n[t[r]]}catch(e){return n}return n},t.set=function(e,t,n){if(!t.length)return(0,r.isObject)(n)?Object.assign(e,n):e=n;for(var a=e,i=0;i<t.length-1;i++)a=a[t[i]]?a[t[i]]:a[t[i]]={};(0,r.isObject)(n)?(a[t[i]]=a[t[i]]||{},Object.assign(a[t[i]],n)):a[t[i]]=n;return e},t.remove=function(e,t){for(var n=e,r=0;r<t.length-1;r++)n=n[t[r]];delete n[t[r]]},t.addConstFields=function(e,t){var n=function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(){throw new Error("Trying to redefine const field '"+n+"'")}})};for(var r in t)n(r)},t.forEach=function(e,t){for(var n in e){var r=e[n];t(r,n,e)}},t.map=function(e,t){var n={};for(var r in e){var a=e[r];n[r]=t(a,r,e)}return n},t.mapKeys=function(e,t){var n={};for(var r in e){var a=e[r],i=t(r,a,e);n[i]=a}return n},t.filter=function(e,t){var n={};for(var r in e){var a=e[r];t(a,r,e)&&(n[r]=a)}return n},t.toObject=function(e,t){var n={};return e.forEach(function(e){n[e]=(0,r.isFunction)(t)?t(e):t}),n},t.fullMap=function(e,t){var n={};for(var r in e){var a=e[r],i=t(r,a,e);n[i[0]||i.key||i.k]=i[1]||i.value||i.v}return n},t.splitPiece=function(e,t){var n={};for(var r in e){var a=e[r];t(a,r,e)&&(n[r]=a,delete e[r])}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={PREFIX:"x-",TEMPLATE_BINDING:"x-b",TEMPLATE_LIST_BINDING:"x-lb",BINDING_ID:"data-x-id",COMPONENT_ID:"data-x-cid",ITEM_INDEX:"data-x-dx",COMPONENT_TYPE:"data-x-tp",ITEM_SUFFIX:"i",STATE_DELIMITER:"-",BASE:"1",COMPONENT:"2",LIST:"3",ITEM:"_item_",SELF:"",FULL_CHANGE:" _full_change_ ",COMPONENT_LIST:"5"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStatePathFromNode=t.prepareChangeObject=t.setState=t.getComponent=t.createAccessor=t.createElement=t.modifyToListBinding=t.createBinding=void 0;var r=d(n(2)),a=n(1),i=n(6),o=n(4),u=n(5),s=d(n(12)),c=d(n(13)),f=n(8),l=n(0);function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.createBinding=O,t.modifyToListBinding=function(e,t){return e.isList=!0,Object.assign(e,{markup:t,listItem:O(t.tagName,e,t)})},t.createElement=function(e){var t=h++,n=e.name,a=m[t]={id:t,bindings:p({},n,e)};return v[t]={},(0,f.createStateNodes)([t,n]),(0,f.sendToRenderQueue)([t],p({},n,!1)),(0,f.applyChanges)(),a.el=v[t][n][r.default.SELF].el,a.ci=g([t,n]),a},t.createAccessor=g,t.getComponent=E,t.setState=function(e,t){(0,a.set)(v,e,t)},t.prepareChangeObject=_,t.getStatePathFromNode=function(e){var t=e.getAttribute(r.default.BINDING_ID).split(r.default.STATE_DELIMITER);t.pop();var n=[],a=void 0;for(;a=(0,i.getRealName)(t.pop());)if((0,i.has)(a,r.default.ITEM)){a=a.slice(r.default.ITEM.length);var o=(e=(0,u.walkUpNodes)(e,function(e){return e.getAttribute(r.default.ITEM_INDEX)})).getAttribute(r.default.ITEM_INDEX);e=e.parentNode,n.unshift(o,a)}else n.unshift(a);return n};var m={},v={},h=1;function g(e){var t=function(e){return(0,a.get)(v,e)}(e),n={component:E(e),values:t,path:e,index:+e[e.length-2],startTransaction:f.startTransaction,applyChanges:f.applyChanges,up:function(t){return function(e,t){var n=t.length;if(""===e||" "===e)return g(t.slice(0,2));if((0,l.isString)(e))for(;n--&&t[n]!==e;);else for(e=e||1;n--&&e--;)(0,l.isNumber)(+t[n-1])&&n--;if(n<1)throw new s.default(e,t);return g(t.slice(0,n+1))}(t,e.slice())},down:function(t){return g(e.concat(t))},set:function(t){return(0,f.setValues)(_(t),e)},get:function(t){return function(e,t,n){var r=e.values,a=e.component;if(!t)return b(r,a,{});var i=a.bindings[t];if(i.isList||i.isComponent)return g(n.concat(t));return r[t].value}(n,t,e)},markup:function(e){return e?n.values[e].el:n.values[r.default.SELF].el}};return(0,l.isArray)(t)&&function(e){Object.assign(e,{get:function(t){return g(e.path.concat(t,e.component.listItem.name))},push:function(t){return(0,f.modifyList)("add",{start:e.values.length,els:t},e)},unshift:function(t){return(0,f.modifyList)("add",{start:0,els:t},e)},add:function(t,n){return(0,f.modifyList)("add",{start:t,els:n},e)},pop:function(t){return(0,f.modifyList)("remove",{start:e.values.length-(t||1),num:t},e)},shift:function(t){return(0,f.modifyList)("remove",{start:0,num:t},e)},remove:function(t,n){return(0,f.modifyList)("remove",{start:t,num:n},e)},length:function(){return e.values.length},value:function(){return y(e)},forEach:function(t){return N(e,t)},filter:function(t){return function(e,t){var n=[];return N(e,function(e,r){t(e,r)&&n.push(e)}),n}(e,t)},map:function(t){return y(e,t)}})}(n),n}function _(e){return(0,a.map)(e,function(e){var t=(0,l.isObject)(e)&&"force"===Object.keys(e)[0];return{value:t?e.force:e,type:"value",force:t}})}function E(e){for(var t=m[e[0]],n=1;n<e.length;n++)(t=t.bindings[e[n]]).isList&&n!==e.length-1&&(t=t.listItem,n+=2);return t}function b(e,t,n){return(0,a.forEach)(e,function(r,a){if(!(0,i.has)(o.RESERVED_BINDING_NAMES,a)){var u=t.bindings[a];if(u.isList)return n[a]=[],void e[a].forEach(function(t,r){var i=n[a][r]={};b(e[a][r][u.listItem.name],u.listItem,i)});if(u.isComponent){var s=n[a]={};b(e[a],u,s)}n[t._links[a]||a]=r.value}}),n}function N(e,t){e.values.forEach(function(n,r){return t(b(n[e.component.listItem.name],e.component.listItem,{}),r)})}function y(e,t){var n=[];return N(e,function(e,r){return n.push(t?t(e,r):e)}),n}function O(e,t,n){if(o.VALUE_TYPES.includes(e))throw new c.default(e);var a=t?{id:t.stateId+r.default.STATE_DELIMITER+e,statePath:t.statePath,stateNames:t.stateNames,isListItem:t.isList,stateId:e}:{},i=n?{initValue:n.value||n.innerHTML}:{};return Object.assign({name:e,listeners:[],markup:n,dependants:{},events:{},evaluate:{},links:{},bindings:p({},r.default.SELF,{}),outerNames:{},_links:{},styles:{}},a,i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RESERVED_BINDING_NAMES=t.BEHAVIOUR_TYPES=t.VALUE_TYPES=void 0;var r,a=n(2),i=(r=a)&&r.__esModule?r:{default:r};var o=t.VALUE_TYPES=["style","class","value","attrs","html"],u=t.BEHAVIOUR_TYPES=["events","hooks","listItem"];t.RESERVED_BINDING_NAMES=o.concat(u,i.default.SELF)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.walkUpNodes=t.emptyNode=t.rewriteToNode=t.insertBeforeNode=t.removeNode=t.walkNodes=t.collectHTMLNodes=t.cloneHTMLMarkup=t.replaceNodes=void 0;var r=n(0);function a(e,t){-1!==t(e)&&Array.prototype.slice.call(e.children).forEach(function(e){return a(e,t)})}function i(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}t.replaceNodes=function(e,t){return e.parentNode.replaceChild(t,e),t},t.cloneHTMLMarkup=function(e){return t=(0,r.isHTMLString)(e.trim())?e:document.querySelector(e).innerHTML,(new DOMParser).parseFromString(t,"text/html").body.firstElementChild;var t},t.collectHTMLNodes=function(e,t){var n=[];return a(e,function(e){return t(e)?n.push(e):""}),n},t.walkNodes=a,t.removeNode=function(e){e.parentNode.removeChild(e)},t.insertBeforeNode=function(e,t){t.parentNode.insertBefore(e,t)},t.rewriteToNode=function(e,t){i(e),function(e,t){var n=document.createTextNode(t);e.appendChild(n)}(e,t)},t.emptyNode=i,t.walkUpNodes=function(e,t,n){var r=e;for(;!t(r);){if("BODY"===r.tagName)return r;n&&n(r),r=r.parentNode}return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRealName=t.getShortName=t.toCamelCase=t.toDashCase=t.getFalsePaths=t.has=void 0;var r=n(0),a=n(1);t.has=function e(t,n){if((0,r.isObject)(t)){var a=Object.keys(t);return e(a,n)}return t.indexOf(n)>=0},t.getFalsePaths=function(e){var t={};return function e(t,n,i){for(var o in t)(0,r.isObject)(t[o])?e(t[o],n,i.concat(o)):!0!==t[o]&&(0,a.set)(n,i.concat(o),t[o])}(e,t,[]),t},t.toDashCase=function(e){return e.replace(/([A-Z])/g,function(e){return"-"+e[0].toLowerCase()})},t.toCamelCase=function(e){return e.replace(/-(.)/g,function(e){return e[1].toUpperCase()})},t.getShortName=function(e){if(i.real[e]>-1)return i.real[e];var t=i.short.push(e);return i.real[e]=t-1},t.getRealName=function(e){return i.short[e]};var i={real:{},short:[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function a(e,t){if(!e)return a({},t);for(var n in t)(0,r.isUndefined)(t[n])||(t.hasOwnProperty(n)&&(0,r.isObject)(t[n])?(e[n]||(e[n]={}),a(e[n],t[n])):(0,r.isArray)(t[n])?(e[n]||(e[n]=[]),i(e[n],t[n])):(0,r.isDOMElement)(t[n])?e[n]=t[n].cloneNode(!0):e[n]=t[n]);return e}function i(e,t){for(var n=0;n<t.length;n++)(0,r.isObject)(t[n])?(e[n]=e[n]||{},a(e[n],t[n])):(0,r.isArray)(t[n])?(e[n]=e[n]||[],i(e[n],t[n])):e[n]=t[n];return e}t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendToRenderQueue=t.applyChanges=t.startTransaction=t.modifyList=t.createStateNodes=t.setValues=void 0;var r=d(n(2)),a=n(1),i=n(0),o=d(n(14)),u=n(6),s=n(3),c=n(9),f=n(4),l=d(n(15));function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.setValues=y,t.createStateNodes=N,t.modifyList=function(e,t,n){var o=n.values,u=n.path,c=n.component.listItem.name,f=t.start,l={};switch(e){case"add":l=function(e,t,n,a,o){return(n=(0,i.isArray)(n)?n:[n]).forEach(function(n,r){e.splice(r+t,0,null),y((0,s.prepareChangeObject)(n),a.concat(r+t,o))}),p({},t,p({},r.default.FULL_CHANGE,{add:{start:t,end:t+n.length}}))}(o,f,t.els,u,c);break;case"remove":var d=f+(t.num||1);l=function(e,t,n,a,i){for(var o={},u=t;u<n;u++){var s=I(e,u,a,i);o[u]=p({},r.default.FULL_CHANGE,{remove:s})}return o}(o,f,d,n.component,n)}if((0,a.forEach)(l,function(e,t){return _(u.concat(t,c,r.default.FULL_CHANGE),l[t][r.default.FULL_CHANGE])}),T(n.component.dependants,n.up().component,n.up(),[]),E())return new Promise(function(e){return v.push(e)});return g()},t.startTransaction=function(){g(),m.collecting=!0},t.applyChanges=g,t.sendToRenderQueue=_;var m={changes:{},collecting:!1},v=[],h={list:[]};function g(){var e=m.changes;return m.changes={},(0,c.renderChanges)(e),function(){var e=h.list;if(h.list=[],e.forEach(function(e){return e()}),!(0,i.isEmpty)(m.changes))return g();return function(){m.collecting=!1;var e=void 0;for(;e=v.pop();)e(!0);return Promise.resolve(!0)}()}()}function _(e,t){(0,a.set)(m.changes,e,t)}function E(){return m.collecting}function b(e,t,n,a){var i=t.hooks[e];h.list.push(function(){var e=t.name||t.statePath[t.statePath.length-1],o=!t.name,u=n[t.name||r.default.SELF].el||n[r.default.SELF].el,s=t.name?a.get(t.name):a.get();i({el:u,value:s,name:e,isComponent:o},a)})}function N(e){var t=(0,s.getComponent)(e),n=function(e){var t=(0,a.map)(e.bindings,function(e){var t=e.isList?[]:{};return f.VALUE_TYPES.reduce(function(t,n){var r=void 0;switch(n){case"value":case"html":r=e.initValue||"";break;default:r={}}return t[n]=r,t},t)});return Object.assign(t,p({},r.default.SELF,(0,a.toObject)(f.VALUE_TYPES,{})))}(t);(0,s.setState)(e,n),(0,a.forEach)(t.bindings,function(t,n){t.isComponent&&N(e.concat(n))});var i=(0,s.createAccessor)(e);return b("mount",t.bindings[r.default.SELF],n,i,e.slice(-2)[0]),n}function y(e,t,n){n=n||[];var i=(0,s.createAccessor)(t);if(!i.values){i.values=N(t);var o=+t.slice(-2)[0];_(t,p({},r.default.FULL_CHANGE,{add:{start:o,end:o+1}}))}return(0,a.forEach)(e,function(e,t){return O(t,e,i,n)}),b("update",i.component.bindings[r.default.SELF],i.values,i,t.slice(-2)[0]),E()?new Promise(function(e){return v.push(e)}):g()}function O(e,t,n,u){var c=n.path,f=n.component,d=n.values,m=f.bindings[e],v=e;if(m||(e=f.outerNames[e],m=f.bindings[e]),!m)throw new l.default(e||v,f.stateName,c);if("value"===t.type){if(m.isList)return function(e,t,n,i){Object.keys(t.value).forEach(function(n){return y((0,s.prepareChangeObject)(t.value[n]),i.path.concat(e.name,n,e.listItem.name))});var u=(0,o.default)(n,t.value),c=0;(0,a.forEach)(u,function(t,a){t.remove&&(t.remove=I(n,a-c,e,i),c++),_(i.path.concat(e.name,a,e.listItem.name),p({},r.default.FULL_CHANGE,t))})}(m,t,d[e],n),void T(m.dependants,f,n,u);if((0,i.isObject)(t.value)&&m.isComponent)return function(e,t,n,r){y((0,s.prepareChangeObject)(t.value),r.concat(e.name))}(m,t,0,c)}var h=(0,o.default)(d[e][t.type],t.value);if(!h||!(0,i.isEmpty)(h)||t.force){if(d[e][t.type]=t.value,"value"!==t.type)return _(c.concat(e),p({},t.type,!1));b("update",m,d,n,c.slice(-2)[0]),u.push(e+":"+t.type),m.html||O(e,{value:t.value,type:"html",force:t.force},n,u);var g=f.links[e];g&&O(g.link,{value:t.value,type:"value",force:t.force},n.down(g.component),[]),T(m.dependants,f,n,u)}}function T(e,t,n,r){(0,a.forEach)(e,function(e,i){if(!(0,u.has)(r,i)){var o=(0,a.mapKeys)(n.get(),function(e){return t.outerNames[e]||e}),s=t.bindings[e.name].evaluate[e.type](o,n);O(e.name,{value:s,type:e.type},n,r)}})}function I(e,t,n,a){var i=e.splice(t,1)[0][n.listItem.name];return b("remove",n.listItem.bindings[r.default.SELF],i,a),i[r.default.SELF].el}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderChanges=t.createAndAppendStyles=void 0;var r,a=n(2),i=(r=a)&&r.__esModule?r:{default:r},o=n(6),u=n(1),s=n(0),c=n(3),f=n(5);t.createAndAppendStyles=function(e){var t="";for(var n in e){var r=e[n];for(var a in t+=n+"{",_(r),r){var i=r[a];t+=(0,o.toDashCase)(a)+":"+i+";"}t+="}\n"}var u=document.createElement("style");u.appendChild(document.createTextNode(t)),document.head.appendChild(u)},t.renderChanges=function(e){(0,u.forEach)(e,function(e,t){var n=Object.keys(e)[0],r=(0,c.createAccessor)([t,n]);d(r.component,r.values,[t,n],e[n])})};var l={html:d,class:function(e,t){for(var n in t)n&&(t[n]?e.markup.classList.add(n):e.markup.classList.remove(n))},style:function(e,t){Object.assign(e.markup.style,_(t))},attrs:function(e,t){Object.assign(e.markup,t)}};function d(e,t,n,r){if(e.markup){if(e.isList)return v(e,t,n,r);if(e.isComponent)return function(e,t,n,r){if(r)return m(e,t,n,r);return p(t,n)}(e,t,n,r);if(t=(0,s.isUndefined)(t)?"":t,"INPUT"!==e.markup.tagName)return(0,f.rewriteToNode)(e.markup,t),e;e.markup.value=t}}function p(e,t){var n=(0,c.createAccessor)(t).component,r=document.createElement("div"),a=n.template.cloneNode(!0);return e[i.default.SELF].el=a,r.appendChild(a),a.setAttribute(i.default.COMPONENT_TYPE,n.isListItem?i.default.ITEM:i.default.COMPONENT),(0,u.forEach)(l,function(t,r){n.bindings[i.default.SELF][r]&&t({markup:a},e[i.default.SELF][r])}),(0,u.forEach)(n.bindings,function(n,a){if(n.markup){var o=r.querySelector("."+i.default.PREFIX+n.id);if(o.classList.remove(i.default.PREFIX+n.id),n.isComponent){var s=t.concat(a),c=p(e[a],s);(0,f.replaceNodes)(o,c)}else e[a].el=o,n.isList?v(n,e[a],t.concat(a)):(0,u.forEach)(l,function(r,i){"html"===i&&null===n.html||n.markup.children.length||r({markup:o},e[a][i],t)})}}),r.children[0]}function m(e,t,n,r){var a=t[i.default.SELF].el;(0,u.forEach)(r,function(o,u){if(u!==i.default.SELF){var s=e.bindings[u],c=n.concat(u);if(s.isComponent||s.isList)d(s,t[u],c,r[u]);else{var f=t[u].el;for(var p in o){var m=t[u][p];l[p]({markup:f},m)}}}else for(var v in o)l[v]({markup:a},t[i.default.SELF][v])})}function v(e,t,n,r){if(r)return function(e,t,n,r){var a=t.el,o=e.listItem.name,d=(0,u.splitPiece)(r,function(e,t){return(0,s.isNumber)(+t)}),p=0,v=0;for(var _ in r)l[_]({markup:a},t[_]);(0,u.forEach)(d,function(r,u){r=r[o];var s=n.concat(u,o),l=(0,c.createAccessor)(s);if(r[i.default.FULL_CHANGE]){if(r[i.default.FULL_CHANGE].add&&u>=v){var d=r[i.default.FULL_CHANGE].add.start;v=r[i.default.FULL_CHANGE].add.end,g(a,d,v-d);var _=h(e,t,n,{start:d,end:v});return v===t.length?void a.appendChild(_):void a.insertBefore(_,a.children[d])}r[i.default.FULL_CHANGE].remove&&((0,f.removeNode)(r[i.default.FULL_CHANGE].remove),g(a,u-p++,-1))}else m(l.component,t[u][o],s,r)})}(e,t,n,r);var a=h(e,t,n),o=t.el,d=o.parentNode,p=o.nextElementSibling;(0,f.removeNode)(o);var v=o.getAttribute(i.default.COMPONENT_TYPE);o.setAttribute(i.default.COMPONENT_TYPE,i.default.LIST),v&&o.setAttribute(i.default.COMPONENT_TYPE,i.default.COMPONENT_LIST),(0,f.emptyNode)(o),o.appendChild(a),d.insertBefore(o,p)}function h(e,t,n,r){var a=r?r.start:0,o=r?r.end:t.length+1,u=document.createDocumentFragment();return t.slice(a,o).forEach(function(t,r){var o=+a+r,s=n.concat([o,e.listItem.name]),c=p(t[e.listItem.name],s);c.setAttribute(i.default.ITEM_INDEX,o),u.appendChild(c)}),u}function g(e,t,n){Array.prototype.slice.call(e.children,t).forEach(function(e){var t=+e.getAttribute(i.default.ITEM_INDEX)+n;e.setAttribute(i.default.ITEM_INDEX,t)})}function _(e){for(var t in e)(0,s.isNumber)(e[t])&&(e[t]=e[t]+"px");return e}},function(e,t,n){"use strict";var r=m(n(2)),a=n(4),i=n(5),o=n(1),u=m(n(7)),s=n(0),c=n(11),f=n(3),l=n(16),d=n(9),p=n(18);function m(e){return e&&e.__esModule?e:{default:e}}e.exports={define:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if((0,s.isObject)(t))return e(n,a,o,t);var c=v+h++;var f=(0,i.cloneHTMLMarkup)(t);f.classList.add(c);var d={name:c,bindings:(m={},g=r.default.SELF,_={},g in m?Object.defineProperty(m,g,{value:_,enumerable:!0,configurable:!0,writable:!0}):m[g]=_,m),stateId:c,statePath:[c],stateNames:{},markup:f,evaluate:{},links:{},isComponent:!0,outerNames:{},_links:{},subComponents:o};var m,g,_;(0,l.gatherBindingsFromMarkup)(f,d,!0);var E=(0,p.prepareBindingsSettings)(n);(0,u.default)(d,E);d.styles=(0,p.prepareStyles)(a,d);(0,l.prepareBindings)(d,d.stateId,{statePath:[],styles:d.styles,links:{},stateNames:d.stateNames});return d},change:function(e,t){var n=(0,u.default)({},e);return(0,o.forEach)(t,function(e,t){(0,o.forEach)((0,p.prepareBindingSettings)(e),function(e,r){if(a.BEHAVIOUR_TYPES.includes(r))(0,o.forEach)(e,function(e,a){var i=n.bindings[t][r][a];n.bindings[t][r][a]=function(t,n){return e.call(null,t,n,i)}});else{var i=n.bindings[t][r];n.bindings[t][r]=function(t,n){return e.call(null,t,n,i)}}})}),n},apply:function(e,t){var n=(0,f.createElement)(t);return(0,d.createAndAppendStyles)(t.styles),(0,c.setupEventHandlers)(n),e.setAttribute(r.default.COMPONENT_TYPE,r.default.BASE),n.el.setAttribute(r.default.COMPONENT_ID,n.id),e.appendChild(n.el),n.ci},extract:function(e){var t=(0,i.walkUpNodes)(e,function(e){return e.getAttribute(r.default.COMPONENT_TYPE)}),n=(0,i.walkUpNodes)(t,function(e){return e.getAttribute(r.default.COMPONENT_TYPE)==r.default.BASE}).firstElementChild.getAttribute(r.default.COMPONENT_ID),a=(0,f.getStatePathFromNode)(t);return(0,f.createAccessor)([n].concat(a))}};var v="c",h=0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupEventHandlers=void 0;var r,a=n(2),i=(r=a)&&r.__esModule?r:{default:r},o=n(1),u=n(5),s=n(3),c=n(8);t.setupEventHandlers=function(e){var t={};!function e(t,n){!function(e,t){if(!e.events)return;for(var n in e.events)t[n]||(t[n]={}),t[n][e.shortId]=e.events[n]}(t,n);t.bindings&&(0,o.forEach)(t.bindings,function(t){return e(t,n)});t.listItem&&e(t.listItem,n)}(e,t);var n=e.el,r=function(e){n.addEventListener(e,function(n){return function(e,t){(function(e){var t=e.stopPropagation.bind(e);e.stopPropagation=function(){e.propagationStopped=!0,t()}})(e),(0,c.startTransaction)();for(var n=[],r=(0,u.walkUpNodes)(e.target,function(e){return e.getAttribute(i.default.COMPONENT_TYPE)==i.default.BASE},function(e){var r=e.getAttribute(i.default.BINDING_ID),a=t[r];a&&n.push({fn:a,path:(0,s.getStatePathFromNode)(e)})}).firstElementChild.getAttribute(i.default.COMPONENT_ID),a=0;a<n.length;a++){var o=n[a],f=o.fn,l=o.path;if(f.call(this,e,(0,s.createAccessor)([r].concat(l))),e.propagationStopped)break}(0,c.applyChanges)()}(n,t[e])})};for(var a in t)r(a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);var a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),i=void 0;return i=(0,r.isNumber)(e)?e+" exceeds the number of components in the chain":"'"+e+"' component doesn't exist in the chain",a.message="Unable to reach the component. "+i+" ("+n.join(" -> ")+").",a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Error),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.message="Can't declare a binding with the name '"+e+"' because it's forbidden name.\nList of forbidden binding names: "+r.VALUE_TYPES.join(", "),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Error),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(0);function i(e,t,n){for(var r in t)(0,a.isArray)(e)?(0,a.isUndefined)(e[r])&&(n.childNode[r]={add:!0}):e[r]!==t[r]&&(n.childNode[r]=!1);for(var i in e)(0,a.isArray)(e)?(0,a.isUndefined)(t[i])&&(n.childNode[i]={remove:!0}):e[i]!==t[i]&&(n.childNode[i]=!1);return n}t.default=function(e,t){if((0,a.isUndefined)(e)||(0,a.isUndefined)(t))return!1;if((void 0===e?"undefined":r(e))!==(void 0===t?"undefined":r(t)))return!1;var n={childNode:{}};if((0,a.isArray)(t))i(e?e.map(function(e){return e}):[],t.map(function(e){return e}),n);else{if(!(0,a.isObject)(t))return e===t;i(e,t,n)}return n.childNode}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(e,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.message="Unable to access '"+e+"' binding on '"+n+"' component on path ("+r.join(" -> ")+") because it doesn't exist.",a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Error),t}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prepareBindings=t.gatherBindingsFromMarkup=void 0;var r=d(n(2)),a=d(n(17)),i=n(4),o=n(5),u=n(1),s=d(n(7)),c=n(0),f=n(6),l=n(3);function d(e){return e&&e.__esModule?e:{default:e}}t.gatherBindingsFromMarkup=function e(t,n,a){a&&(m=0);(0,o.walkNodes)(t,function(t){var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=g(e);if(!n)return null;var a=t[n];if(a)return _(n,a);var i=e.getAttribute(r.default.TEMPLATE_BINDING);if(e.removeAttribute(r.default.TEMPLATE_BINDING),i)return{name:i.trim()};if(i=e.getAttribute(r.default.TEMPLATE_LIST_BINDING),e.removeAttribute(r.default.TEMPLATE_LIST_BINDING),i)return{name:i.trim(),isList:!0}}(t,n.subComponents);if(a){var i=(0,l.createBinding)(a.name,n,t);if(a.isComponent&&(h(i,a),t.classList.add(r.default.PREFIX+i.id)),n.bindings[i.name]=i,i.markup.classList.add(r.default.PREFIX+i.id,n.name+"-"+i.name),a.isList){var o=t.children[0];(0,l.modifyToListBinding)(i,o);var u=g(o);return n.subComponents[u]?(h(i.listItem,_(u,n.subComponents[u])),-1):(e(o,i.listItem),-1)}}});return n},t.prepareBindings=function e(t,n,o){var s=document.createElement("div");t.markup.setAttribute(r.default.BINDING_ID,E(n+r.default.STATE_DELIMITER+r.default.SELF));s.appendChild(t.markup);t.statePath=o.statePath.concat(t.stateId);t.stateNames=o.stateNames;var f=[];(0,u.forEach)(t.bindings,function(u,d){var p=u.id,m=n+r.default.STATE_DELIMITER+d,h=E(m);if(u.markup){var g=s.querySelector("."+r.default.PREFIX+p);g.setAttribute(r.default.BINDING_ID,h),g.classList.remove(r.default.PREFIX+p),g.classList.add(r.default.PREFIX+m)}if(Object.assign(u,{statePath:t.statePath.slice(),hooks:Object.assign({},v,u.hooks),id:m,shortId:h}),function(e,t){i.VALUE_TYPES.forEach(function(n){var r=e[n];r&&(e.evaluate[n]=function(e,t,n,r){return function(e){var t=function(e){var t=e.toString().replace(a.default.STRIP_COMMENTS,"");return t.slice(t.indexOf("(")+1,t.indexOf(")")).match(a.default.ARGUMENT_NAMES)||[]}(e),n=new RegExp("\\"+t[0]+"\\.(\\D[^\\s\\W]+)","g"),r=[],i=e.toString(),o=void 0;for(;o=n.exec(i);)r.push(o[1]);return r}(n).forEach(function(n){(0,c.isEmpty)(r.bindings[n])&&(r.bindings[n]=(0,l.createBinding)(n,r)),r.bindings[n].dependants[e.name+":"+t]={name:e.name,type:t}}),function(e,t){return n.call(null,e,t)}}(e,n,r,t))})}(u,t),u.isList)return u.statePath.push(d),u.stateNames=t.stateNames,u.styles=o.styles,void e(u.listItem,m+r.default.STATE_DELIMITER+r.default.ITEM+u.listItem.name,u);u.isComponent&&f.push(u)});!function(e,t){Object.assign(t.links,(0,u.map)(e.outerNames,function(t){return{link:t,component:e.stateId}}))}(t,o);t.template=t.markup.cloneNode(!0);Object.assign(o.styles,t.styles);f.forEach(function(a){e(a,n+r.default.STATE_DELIMITER+a.stateId,t)})};var p="x",m=0,v=(0,u.toObject)(["mount","update","remove"],function(){return function(){}});function h(e,t){var n=Object.assign(e.stateNames,t.component.stateNames),r=t.stateName+p+m++;return n[t.stateName]||(r=t.stateName,e.stateNames[r]=!0),(0,s.default)(e,t.component),Object.assign(e,{id:r,stateId:r,name:r,stateName:t.stateName,statePath:e.statePath.concat(r),markup:t.component.markup.cloneNode(!0),isComponent:!0,stateNames:n,_links:Object.assign({},t.links),outerNames:Object.assign({},t.revLinks)})}function g(e){return e.tagName&&(0,f.toCamelCase)(e.tagName.toLowerCase())}function _(e,t){return{component:t[0],links:t[1],revLinks:t[1]?(0,u.fullMap)(t[1],function(e,t){return[t,e]}):{},stateName:e,name:e,isComponent:!0}}function E(e){return e.split(r.default.STATE_DELIMITER).map(function(e){return(0,f.getShortName)(e)}).join(r.default.STATE_DELIMITER)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={STRIP_COMMENTS:/(\/\/.*$)|(\/\*[\s\S]*?\*\/)|(\s*=[^,)]*(('(?:\\'|[^'\r\n])*')|("(?:\\"|[^"\r\n])*"))|(\s*=[^,)]*))/gm,ARGUMENT_NAMES:/([^\s,]+)/g}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prepareStyles=t.prepareBindingsSettings=t.prepareBindingSettings=void 0;var r,a=n(1),i=n(3),o=n(19),u=(r=o)&&r.__esModule?r:{default:r};function s(e){var t={};return(0,a.forEach)(e,function(e,n){for(var r=0;r<u.default.length;r++){var a=u.default[r];if(a.names[n])return a.group?(t[a.group]||(t[a.group]={}),void(t[a.group][a.names[n]]=e)):void(t[a.names[n]]=e)}t[n]=e}),t}t.prepareBindingSettings=s,t.prepareBindingsSettings=function(e){var t={bindings:{}};return(0,a.forEach)(e,function(e,n){var r=(0,i.createBinding)(n);Object.assign(r,s(e)),t.bindings[n]=r}),t},t.prepareStyles=function(e,t){return(0,a.mapKeys)(e,function(e){return e.split(",").map(function(e){return e.trim()}).map(function(e){var n="."+t.name;if(e){var r=e.split(" ")[0].split("::")[0].split(":")[0],a=t.bindings[r]&&!!r,i=e.startsWith(":")?"":" ",o=a?n+"-":"";n+=i+o+e}return n}).join(",")})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=[{names:{_s:"style",_c:"class",_v:"value",_a:"attrs",_h:"html"}},{group:"events",names:{_eab:"abort",_eld:"load",_eer:"error",_ef:"focus",_efi:"focusin",_efo:"focusout",_eb:"blur",_eas:"animationstart",_eac:"animationcanceled",_eae:"animationend",_eai:"animationiteration",_ets:"transitionstart",_etc:"transitioncancel",_ete:"transitionend",_etr:"transitionrun",_efr:"reset",_efs:"submit",_ekd:"keydown",_ekp:"keypress",_eku:"keyup",_emc:"click",_emx:"contextmenu",_emd:"mousedown",_eme:"mouseenter",_eml:"mouseleave",_emm:"mousemove",_emo:"mouseover",_emt:"mouseout",_emu:"mouseup",_empc:"pointerlockchange",_empe:"pointerlockerror",_emw:"wheel",_ems:"select",_ed:"drag",_ede:"dragend",_edr:"dragenter",_eds:"dragstart",_edl:"dragleave",_edo:"dragover",_edd:"drop",_emcp:"canplay",_emcpt:"canplaythrough",_emdc:"duractionchange",_emet:"emptied",_emnd:"ended",_emld:"loadeddata",_emlmd:"loadedmetadata",_emps:"pause",_empl:"play",_emplg:"playing",_emrc:"ratechange",_emsk:"seeked",_emskg:"seeking",_emst:"stalled",_emsd:"suspend",_emtu:"timeupdate",_emvc:"volumechange",_emwt:"waiting"}},{group:"hooks",names:{_hu:"update",_hm:"mount",_hr:"remove"}}]}])});